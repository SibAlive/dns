{% extends 'header/base.html' %}

{% block content %}
{{ super() }}

<title>–ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤</title>

<div class="search=container">
<!--        –®–∞–ø–∫–∞ –ø–æ–∏—Å–∫–∞-->
    <div class="search-header">
        <h1>üîç –ü–æ–∏—Å–∫ —Ç–æ–≤–∞—Ä–æ–≤</h1>
        <p>–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –∏–ª–∏ –∞—Ä—Ç–∏–∫—É–ª –¥–ª—è –ø–æ–∏—Å–∫–∞</p>
    </div>

<!--        –§–æ—Ä–º–∞ –ø–æ–∏—Å–∫–∞-->
    <div class="search-form-wrapper">
        <form class="search-form" method="GET" action="/search">
            <input
                type="text"
                class="search-input"
                name="q"
                placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Iphone 17, –¢–µ–ª–µ–≤–∏–∑–æ—Ä Xiaomi..."
                value="{{ query if query else '' }}">
            <button type="submit" class="search-btn">
                –ù–∞–π—Ç–∏ —Ç–æ–≤–∞—Ä—ã
            </button>
        </form>
    </div>

<!--        –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞-->
    <div class="search-results">
        {% if query %}
            <div class="result-header">
                <div class="result-count">
                    –ù–∞–π–¥–µ–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ –∑–∞–ø—Ä–æ—Å—É
                    <span class="results-query">{{ query }}</span>:
                    {{ products | length }}
                </div>
                {% if products %}
                    <a href="{{ url_for('catalog.catalog_index') }}" class="search-btn">–ö–∞—Ç–∞–ª–æ–≥</a>
                {% endif %}
            </div>
        {% endif %}

        {% if products %}
            <div class="products-grid">
                {% for product in products %}
                    <div class="product-card">
                        <a href="{{ url_for(
                        'catalog.product',
                        product_slug=product.slug) }}" class="no-underline">
                            <div class="product-image">
                                {% set main_img = product.images | selectattr('is_main') | first %}
                                  {% if main_img %}
                                    <img src="{{ url_for('catalog.static', filename='images/' ~ main_img.image_path) }}"
                                         alt="{{ product.name }}"
                                         class="gallery-main-img"
                                         id="mainProductImg">
                                  {% else %}
                                    <img src="{{ url_for('catalog.static', filename='images/placeholder.jpg') }}"
                                         alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
                                         class="gallery-main-img"
                                         id="mainProductImg">
                                  {% endif %}
                            </div>
                            <div class="product-info">
                                <div class="product-title">{{ product.name }}</div>
                                <div class="product-price">{{ product.price | money }} ‚ÇΩ</div>
                            </div>
                        </a>
                    </div>
                {% endfor %}
            </div>
        {% elif query %}
            <div class="no-results">
                <div class="no-results-icon">üîç</div>
                <h2>–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h2>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –∑–∞–ø—Ä–æ—Å –∏–ª–∏ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å <a href="{{
                url_for('catalog.catalog_index') }}">–í–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥</a></p>
            </div>
        {% endif %}
    </div>
</div>

{% endblock %}